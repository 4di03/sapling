"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["5832"],{95463:function(e,n,o){o.r(n),o.d(n,{metadata:()=>s,contentTitle:()=>r,default:()=>l,assets:()=>m,toc:()=>d,frontMatter:()=>i});var s=JSON.parse('{"id":"overview/rebase","title":"Rebase","description":"While the word \\"rebase\\" is a bit confusing, it fundamentally just means moving","source":"@site/docs/overview/rebase.md","sourceDirName":"overview","slug":"/overview/rebase","permalink":"/docs/overview/rebase","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/sapling/tree/main/website/docs/overview/rebase.md","tags":[],"version":"current","sidebarPosition":70,"frontMatter":{"sidebar_position":70},"sidebar":"tutorialSidebar","previous":{"title":"Stacks of commits","permalink":"/docs/overview/stacks"},"next":{"title":"Pull / push","permalink":"/docs/overview/push-pull"}}'),a=o("85893"),t=o("50065");let i={sidebar_position:70},r="Rebase",m={},d=[{value:"Examples",id:"examples",level:3},{value:"-b / --base",id:"-b----base",level:4},{value:"-s / --source",id:"-s----source",level:4},{value:"-r / --revisions",id:"-r----revisions",level:4},{value:"Other",id:"other",level:4}];function c(e){let n={code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,t.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"rebase",children:"Rebase"})}),"\n",(0,a.jsxs)(n.p,{children:['While the word "rebase" is a bit confusing, it fundamentally just means moving\ncommits from one part of the repository to another. In Sapling, this is\ndone with the ',(0,a.jsx)(n.code,{children:"sl rebase"})," command."]}),"\n",(0,a.jsx)(n.p,{children:"Rebasing requires two pieces of information:"}),"\n",(0,a.jsxs)(n.ol,{children:["\n",(0,a.jsxs)(n.li,{children:["Which commits will be moved, via one of the flags ",(0,a.jsx)(n.code,{children:"-r"})," (revisions), ",(0,a.jsx)(n.code,{children:"-s"})," (source), or  ",(0,a.jsx)(n.code,{children:"-b"})," (base)."]}),"\n",(0,a.jsxs)(n.li,{children:["The destination commit to move the commits to, via the ",(0,a.jsx)(n.code,{children:"-d"}),"\n(destination) flag."]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,a.jsxs)(n.p,{children:["To illustrate the different types of rebases, assume we start with the following\ncommit graph. Note that we are currently on Commit C, as indicated by the ",(0,a.jsx)(n.code,{children:"@"}),"\nsymbol."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sl-shell-example",children:"$ sl\no  d78f66e01  106 seconds ago  remote/main\n\u2577\n\u2577 o  306ce5ffb  67 seconds ago  mary\n\u2577 \u2502  Commit F\n\u2577 \u2502\n\u2577 o  2ff5f28a1  67 seconds ago  mary\n\u2577 \u2502  Commit E\n\u2577 \u2502\n\u2577 \u2502 o  e5513dac4  67 seconds ago  mary\n\u2577 \u2502 \u2502  Commit D\n\u2577 \u2502 \u2502\n\u2577 \u2502 @  6f782187a  67 seconds ago  mary\n\u2577 \u251C\u2500\u256F  Commit C\n\u2577 \u2502\n\u2577 o  3beadc099  67 seconds ago  mary\n\u2577 \u2502  Commit B\n\u2577 \u2502\n\u2577 o  b48ce5c8e  67 seconds ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n"})}),"\n",(0,a.jsx)(n.h4,{id:"-b----base",children:"-b / --base"}),"\n",(0,a.jsxs)(n.p,{children:["The most common use for rebase is to move your in-progress commits onto a newer\nversion of main.  The ",(0,a.jsx)(n.code,{children:"-b"})," flag is ideal for this situation, as it will take the\nentire subtree of your commits and move them onto the destination."]}),"\n",(0,a.jsxs)(n.p,{children:["Below we use ",(0,a.jsx)(n.code,{children:"-b ."})," to rebase the current commit, ",(0,a.jsx)(n.code,{children:"."}),", and its entire related\nsubtree onto main. In this case, the subtree is Commit A and all of its\ndescendants."]}),"\n",(0,a.jsxs)(n.p,{children:["Note that ",(0,a.jsx)(n.code,{children:"sl rebase -b . -d XXX"})," is the same as ",(0,a.jsx)(n.code,{children:"sl rebase -d XXX"}),", as ",(0,a.jsx)(n.code,{children:"-b ."}),"\nis the default behavior."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sl-shell-example",children:"# Move entire current subtree onto main.\n$ sl rebase -b . -d main\n  o  91ecebda8  12 seconds ago  mary\n  \u2502  Commit F\n  \u2502\n  o  b26b55434  12 seconds ago  mary\n  \u2502  Commit E\n  \u2502\n  \u2502 o  a9ef0ee2d  12 seconds ago  mary\n  \u2502 \u2502  Commit D\n  \u2502 \u2502\n  \u2502 @  37d2d0296  12 seconds ago  mary\n  \u251C\u2500\u256F  Commit C\n  \u2502\n  o  37d536158  12 seconds ago  mary\n  \u2502  Commit B\n  \u2502\n  o  81910236f  12 seconds ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\no  d78f66e01  15 minutes ago  remote/main\n\u2577\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n"})}),"\n",(0,a.jsx)(n.h4,{id:"-s----source",children:"-s / --source"}),"\n",(0,a.jsxs)(n.p,{children:["If you don't want to rebase the entire subtree with ",(0,a.jsx)(n.code,{children:"-b"}),", you can use ",(0,a.jsx)(n.code,{children:"-s"})," to\nrebase a given commit and all of its descendants."]}),"\n",(0,a.jsxs)(n.p,{children:["Below we use ",(0,a.jsx)(n.code,{children:"-s ."})," to rebase the current commit, ",(0,a.jsx)(n.code,{children:"."}),", and its descendant\n",(0,a.jsx)(n.code,{children:"Commit D"})," onto ",(0,a.jsx)(n.code,{children:"main"}),". All other commits are left behind."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sl-shell-example",children:"# Move current commit and its descendants onto main.\n$ sl rebase -s . -d main\n  o  aa40b4d44  44 seconds ago  mary\n  \u2502  Commit D\n  \u2502\n  @  95cf1e999  44 seconds ago  mary\n\u256D\u2500\u256F  Commit C\n\u2502\no  d78f66e01  11 minutes ago  remote/main\n\u2577\n\u2577 o  306ce5ffb  11 minutes ago  mary\n\u2577 \u2502  Commit F\n\u2577 \u2502\n\u2577 o  2ff5f28a1  11 minutes ago  mary\n\u2577 \u2502  Commit E\n\u2577 \u2502\n\u2577 o  3beadc099  11 minutes ago  mary\n\u2577 \u2502  Commit B\n\u2577 \u2502\n\u2577 o  b48ce5c8e  11 minutes ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n"})}),"\n",(0,a.jsx)(n.h4,{id:"-r----revisions",children:"-r / --revisions"}),"\n",(0,a.jsxs)(n.p,{children:["If we only want to move a specific commit or commits, we use ",(0,a.jsx)(n.code,{children:"-r"})," to move\nexactly the commits we specified."]}),"\n",(0,a.jsxs)(n.p,{children:["Below we move the commit we're on by specifying ",(0,a.jsx)(n.code,{children:"."})," as the argument to ",(0,a.jsx)(n.code,{children:"-r"}),".  We\nmove it onto ",(0,a.jsx)(n.code,{children:"main"})," by specifying ",(0,a.jsx)(n.code,{children:"main"})," as the argument to ",(0,a.jsx)(n.code,{children:"-d"}),"."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sl-shell-example",children:'# Move just the current commit to be based on main\n$ sl rebase -r . -d main\nrebasing 6f782187aa42 "Commit C"\n6f782187aa42 -> 8abef7d37f3a "Commit C"\n$ sl\n  @  8abef7d37  6 seconds ago  mary\n\u256D\u2500\u256F  Commit C\n\u2502\no  d78f66e01  4 minutes ago  remote/main\n\u2577\n\u2577 o  306ce5ffb  3 minutes ago  mary\n\u2577 \u2502  Commit F\n\u2577 \u2502\n\u2577 o  2ff5f28a1  3 minutes ago  mary\n\u2577 \u2502  Commit E\n\u2577 \u2502\n\u2577 \u2502 o  e5513dac4  3 minutes ago  mary\n\u2577 \u2502 \u2502  Commit D\n\u2577 \u2502 \u2502\n\u2577 \u2502 x  6f782187a [Rebased to 8abef7d37f3a]  3 minutes ago  mary\n\u2577 \u251C\u2500\u256F  Commit C\n\u2577 \u2502\n\u2577 o  3beadc099  3 minutes ago  mary\n\u2577 \u2502  Commit B\n\u2577 \u2502\n\u2577 o  b48ce5c8e  3 minutes ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n'})}),"\n",(0,a.jsxs)(n.p,{children:["Note how ",(0,a.jsx)(n.code,{children:"6f782187a"})," is identified with an ",(0,a.jsx)(n.code,{children:"x"})," in the commit graph to denote that it\nhas been rewritten to the newer version ",(0,a.jsx)(n.code,{children:"8abef7d37f3a"}),".  However, it is still visible\nbecause commit D did not get rebased."]}),"\n",(0,a.jsx)(n.h4,{id:"other",children:"Other"}),"\n",(0,a.jsxs)(n.p,{children:["The rebase command can move multiple stacks and subtrees in a single invocation. The tree structure will be retained across the rebase. For example, one can use the ",(0,a.jsx)(n.code,{children:"draft()"})," revset to rebase all of your local commits onto a newer base commit."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sl-shell-example",children:"$ sl\no  b5d600552  27 seconds ago  remote/main\n\u2577\n\u2577 o  9d5ba71bc  2 minutes ago  mary\n\u2577 \u2502  Commit C\n\u2577 \u2502\n\u2577 \u2502 o  37d536158  12 minutes ago  mary\n\u2577 \u251C\u2500\u256F  Commit B\n\u2577 \u2502\n\u2577 o  81910236f  12 minutes ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\no  d78f66e01  27 minutes ago\n\u2577\n\u2577 @  ecf227650  69 seconds ago  mary\n\u2577 \u2502  Commit Two\n\u2577 \u2502\n\u2577 o  5da2b3e5a  91 seconds ago  mary\n\u256D\u2500\u256F  Commit One\n\u2502\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n\n# Rebase all my commits onto new main.\n$ sl rebase -r 'draft()' -d main\n\n$ sl\n  o  3c5549fb7  10 seconds ago  mary\n  \u2502  Commit C\n  \u2502\n  \u2502 o  ed3106510  10 seconds ago  mary\n  \u251C\u2500\u256F  Commit B\n  \u2502\n  o  23a6f6012  10 seconds ago  mary\n\u256D\u2500\u256F  Commit A\n\u2502\n\u2502 @  9f73762dd  10 seconds ago  mary\n\u2502 \u2502  Commit Two\n\u2502 \u2502\n\u2502 o  9d550d707  10 seconds ago  mary\n\u251C\u2500\u256F  Commit One\n\u2502\no  b5d600552  3 minutes ago  remote/main\n\u2577\no  17af69994  Today at 08:33  remote/stable\n\u2577\n~\n"})})]})}function l(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},50065:function(e,n,o){o.d(n,{Z:function(){return r},a:function(){return i}});var s=o(67294);let a={},t=s.createContext(a);function i(e){let n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);