"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([["2149"],{17469:function(e,t,n){n.r(t),n.d(t,{metadata:()=>s,contentTitle:()=>d,default:()=>h,assets:()=>c,toc:()=>l,frontMatter:()=>r});var s=JSON.parse('{"id":"git/git_support_modes","title":"Git support modes","description":"Sapling supports Git in 2 modes. Here is a quick comparison:","source":"@site/docs/git/git_support_modes.md","sourceDirName":"git","slug":"/git/git_support_modes","permalink":"/docs/git/git_support_modes","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/sapling/tree/main/website/docs/git/git_support_modes.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"Using Sapling with GitHub","permalink":"/docs/git/github"},"next":{"title":"Signing Commits","permalink":"/docs/git/signing"}}'),i=n("85893"),o=n("50065");let r={sidebar_position:3},d="Git support modes",c={},l=[{value:"<code>.git</code> mode",id:"git-mode",level:2},{value:"<code>.sl</code> mode",id:"sl-mode",level:2}];function a(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",section:"section",sup:"sup",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"git-support-modes",children:"Git support modes"})}),"\n",(0,i.jsx)(t.p,{children:"Sapling supports Git in 2 modes. Here is a quick comparison:"}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{}),(0,i.jsxs)(t.th,{children:[(0,i.jsx)(t.code,{children:".git"})," mode"]}),(0,i.jsxs)(t.th,{children:[(0,i.jsx)(t.code,{children:".sl"})," mode"]})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Repo created by"}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"git clone"})," or ",(0,i.jsx)(t.code,{children:"git init"})]}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"sl clone"})," or ",(0,i.jsx)(t.code,{children:"sl init"})]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Repo directory"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:".git"})}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.code,{children:".sl"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"git"})," commands"]}),(0,i.jsx)(t.td,{children:"\u2705 Supported"}),(0,i.jsx)(t.td,{children:"\u26A0\uFE0F Not supported"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"https://git-lfs.com/",children:"Git LFS"})}),(0,i.jsxs)(t.td,{children:["Partially supported ",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),(0,i.jsx)(t.td,{children:"\u26A0\uFE0F Not supported"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Submodules"}),(0,i.jsx)(t.td,{children:"Work-In-Progress"}),(0,i.jsx)(t.td,{children:(0,i.jsx)(t.a,{href:"submodule",children:"Supported without EdenFS"})})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.a,{href:"../addons/isl",children:"ISL"})," (graphic interface)"]}),(0,i.jsx)(t.td,{children:"\u2705 Supported"}),(0,i.jsx)(t.td,{children:"\u2705 Supported"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"EdenFS (virtual filesystem)"}),(0,i.jsx)(t.td,{children:"\u26A0\uFE0F Not supported"}),(0,i.jsxs)(t.td,{children:["\u2705 Supported (experimental ",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),")"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Git network protocol (Git or Mononoke server)"}),(0,i.jsx)(t.td,{children:"\u2705 Supported"}),(0,i.jsx)(t.td,{children:"\u2705 Supported"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Sapling network protocol (Mononoke server)"}),(0,i.jsx)(t.td,{children:"\u26A0\uFE0F Not supported"}),(0,i.jsxs)(t.td,{children:["\u2705 Supported (experimental ",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-2",id:"user-content-fnref-2-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})}),")"]})]})]})]}),"\n",(0,i.jsxs)(t.h2,{id:"git-mode",children:[(0,i.jsx)(t.code,{children:".git"})," mode"]}),"\n",(0,i.jsxs)(t.p,{children:["In this mode, Sapling tries to be compatible with ",(0,i.jsx)(t.code,{children:".git/"})," file formats so you can run ",(0,i.jsx)(t.code,{children:"git"})," commands. For features not natively supported by Git like ",(0,i.jsx)(t.a,{href:"../dev/internals/visibility-and-mutation#commit-mutation",children:"mutation"}),", Sapling will store them in the ",(0,i.jsx)(t.code,{children:".git/sl"})," directory."]}),"\n",(0,i.jsxs)(t.p,{children:["There are some caveats using the ",(0,i.jsx)(t.code,{children:".git"})," mode:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Mixing ",(0,i.jsx)(t.code,{children:"sl"})," and ",(0,i.jsx)(t.code,{children:"git"})," commands might not work in all cases. For example:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["If your ",(0,i.jsx)(t.code,{children:"sl rebase"})," is interrupted, use ",(0,i.jsx)(t.code,{children:"sl rebase --continue"})," to continue, you cannot use ",(0,i.jsx)(t.code,{children:"git rebase --continue"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Similarity, use ",(0,i.jsx)(t.code,{children:"git rebase --continue"})," for an interrupted ",(0,i.jsx)(t.code,{children:"git rebase"}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["If you run ",(0,i.jsx)(t.code,{children:"sl add"})," to mark a file as tracked, use ",(0,i.jsx)(t.code,{children:"sl status"})," and ",(0,i.jsx)(t.code,{children:"sl commit"})," to commit the change. ",(0,i.jsx)(t.code,{children:"sl add"})," might not affect ",(0,i.jsx)(t.code,{children:"git status"})," or ",(0,i.jsx)(t.code,{children:"git commit"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"sl"})," might put the repo in a ",(0,i.jsx)(t.a,{href:"https://git-scm.com/docs/git-checkout#_detached_head",children:'"detached head"'})," state. This is okay if you only run ",(0,i.jsx)(t.code,{children:"sl"})," commands. However, if you use ",(0,i.jsx)(t.code,{children:"git"})," commands, be sure to run ",(0,i.jsx)(t.code,{children:"git branch some_name"})," to create a branch before ",(0,i.jsx)(t.code,{children:"git checkout"})," away to avoid losing commits."]}),"\n",(0,i.jsxs)(t.li,{children:["LFS ",(0,i.jsx)(t.sup,{children:(0,i.jsx)(t.a,{href:"#user-content-fn-1",id:"user-content-fnref-1-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})," or other ",(0,i.jsx)(t.code,{children:".gitattributes"})," features are partially supported. ",(0,i.jsx)(t.code,{children:"sl goto"})," runs ",(0,i.jsx)(t.code,{children:"git checkout"})," under the hood. Other ",(0,i.jsx)(t.code,{children:"sl"})," commands like ",(0,i.jsx)(t.code,{children:"commit"})," or ",(0,i.jsx)(t.code,{children:"diff"})," do not respect ",(0,i.jsx)(t.code,{children:".gitattributes"}),". You can use ",(0,i.jsx)(t.code,{children:"git"})," instead."]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"sl"})," does not have local tags. You can use ",(0,i.jsx)(t.code,{children:"origin/tags/v1.0"})," to refer to the ",(0,i.jsx)(t.code,{children:"v1.0"})," tag stored on the ",(0,i.jsx)(t.code,{children:"origin"})," server."]}),"\n",(0,i.jsx)(t.li,{children:"Currently, sub-modules are not fully supported."}),"\n",(0,i.jsx)(t.li,{children:"Currently, ISL might not detect repo changes as quickly or automatically as other modes. Use the refresh button to recheck manually if necessary."}),"\n"]}),"\n",(0,i.jsxs)(t.h2,{id:"sl-mode",children:[(0,i.jsx)(t.code,{children:".sl"})," mode"]}),"\n",(0,i.jsx)(t.p,{children:"In this mode, Sapling can utilize more scalability features, although some are not yet built in the public release. For example:"}),"\n",(0,i.jsx)(t.p,{children:"For the working copy implementation, Sapling can use its own implementations:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["Physical filesystem: together with ",(0,i.jsx)(t.a,{href:"https://facebook.github.io/watchman/",children:"watchman"}),", ",(0,i.jsx)(t.code,{children:"add"})," or ",(0,i.jsx)(t.code,{children:"remove"})," operations can be O(changed files) instead of O(total files). There is no need to re-write a potentially large file like ",(0,i.jsx)(t.a,{href:"https://git-scm.com/docs/gitformat-index",children:(0,i.jsx)(t.code,{children:".git/index"})}),"."]}),"\n",(0,i.jsxs)(t.li,{children:["Virtual filesystem (EdenFS): With ",(0,i.jsx)(t.code,{children:"eden"}),", and ",(0,i.jsx)(t.code,{children:"sl"})," built with Thrift support, you can run ",(0,i.jsx)(t.code,{children:"eden clone <sl_git_working_copy> <new_working_copy>"})," to get a virtual working copy which has much better ",(0,i.jsx)(t.code,{children:"goto"})," performance."]}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["For server protocols, Sapling can use dedicated lazy commit graph protocols so ",(0,i.jsx)(t.code,{children:"clone"})," and ",(0,i.jsx)(t.code,{children:"pull"})," are roughly O(merges) both in time and space usage."]}),"\n",(0,i.jsxs)(t.p,{children:["For local storage, Sapling can use its ",(0,i.jsx)(t.a,{href:"../dev/internals/indexedlog",children:"own structure"})," and ",(0,i.jsx)(t.a,{href:"../dev/internals/zstdelta",children:"compression"})," so the file count is bounded and there is no need to repack. Note: This is not fully implemented for the git format yet but is the direction we'd like to go."]}),"\n","\n",(0,i.jsxs)(t.section,{"data-footnotes":!0,className:"footnotes",children:[(0,i.jsx)(t.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{id:"user-content-fn-1",children:["\n",(0,i.jsxs)(t.p,{children:["Sapling can write Git LFS files to disk on ",(0,i.jsx)(t.code,{children:"goto"}),". However, if you need to make changes or create new LFS files, or view their diffs, you need to use ",(0,i.jsx)(t.code,{children:"git"})," commands. ",(0,i.jsx)(t.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21A9"})," ",(0,i.jsxs)(t.a,{href:"#user-content-fnref-1-2","data-footnote-backref":"","aria-label":"Back to reference 1-2",className:"data-footnote-backref",children:["\u21A9",(0,i.jsx)(t.sup,{children:"2"})]})]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{id:"user-content-fn-2",children:["\n",(0,i.jsxs)(t.p,{children:["Source code to support those exists on GitHub. However, EdenFS, Mononoke, and Sapling with EdenFS support are not yet part of the public GitHub releases yet. ",(0,i.jsx)(t.a,{href:"#user-content-fnref-2","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21A9"})," ",(0,i.jsxs)(t.a,{href:"#user-content-fnref-2-2","data-footnote-backref":"","aria-label":"Back to reference 2-2",className:"data-footnote-backref",children:["\u21A9",(0,i.jsx)(t.sup,{children:"2"})]})]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},50065:function(e,t,n){n.d(t,{Z:function(){return d},a:function(){return r}});var s=n(67294);let i={},o=s.createContext(i);function r(e){let t=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function d(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:t},e.children)}}}]);